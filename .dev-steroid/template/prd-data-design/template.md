# データ設計書
> 本書は「運用・拡張・移行」まで見据えた設計を記述する。テーブル定義は“実装可能”な粒度で、索引/制約/保持期間も含める。
> **全セクション必須**。該当しない場合は「該当なし」と記載し、セクション自体は削除しない。
## 0. サマリ
- 対象範囲：
- 主要な設計判断（Design decisions）：
- データの責務（どこに何を持つか）：
## 1. データモデル（論理）
### 1.1 エンティティ一覧
| エンティティ | 説明 | 主キー | 主要属性 | 備考 |
|---|---|---|---|---|
### 1.2 ER（テキスト図で可）
```text
(例)
User 1 --- * Order
```
## 2. 物理設計（テーブル/スキーマ）
### 2.1 テーブル一覧
| テーブル | 目的 | 主キー | 参照 | 主要インデックス | 備考 |
|---|---|---|---|---|---|
### 2.2 テーブル定義（テーブルごと）
#### <table_name>
| カラム | 型 | NULL | PK/FK | DEFAULT | 制約/説明 |
|---|---|---|---|---|---|
- インデックス：
- 参照整合性：
- 代表クエリ/アクセスパターン：
- 保持期間/削除方針：
## 3. 制約/整合性
- 主キー：
- 外部キー：
- 一意制約：
- CHECK/参照整合性：
- 正規化/非正規化の判断：
## 4. 移行/マイグレーション方針
- 既存データがある場合の移行戦略：
- 後方互換（追加/変更/削除のルール）：
- ロールバック方針：
## 5. セキュリティ/プライバシー（データ観点）
- データ分類（PII 等）：
- マスキング/匿名化：
- 暗号化：
- アクセス制御（DB権限/RLS 等）：
## 6. バックアップ/リストア
- バックアップ方式：
- RPO/RTO（目標）：
- 復旧手順（要点）：
## 7. 未決・TODO
-
## 8. レビューステータス
- AIレビュー：未実施 / reviewed / 指摘あり
- ユーザー承認：未承認 / approved
- 備考：

<!-- generation_hints:
- エンティティ/テーブルは一覧→定義→制約→インデックス→代表クエリの順で一貫して記述する
- データ分類（PII 等）とアクセス制御の要点を明記し、セキュリティ設計と矛盾させない
- 移行/マイグレーション方針（後方互換/ロールバック）を"実務で使える粒度"で書く
- 分割する場合はドメイン/スキーマ単位で分割し、エントリポイントからリンクする
-->
<!-- review_criteria:
- テーブル定義（型/NULL/制約/インデックス）が実装可能な粒度で揃っている
- 代表クエリ/アクセスパターンに対してインデックス等の根拠がある
- マイグレーション/後方互換/ロールバックが実務で使えるレベルで記載されている
- データ分類/アクセス制御がセキュリティ設計と矛盾しない
-->
